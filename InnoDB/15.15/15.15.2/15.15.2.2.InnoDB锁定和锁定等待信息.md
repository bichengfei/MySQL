# 15.15.2.2 InnoDB 锁定和锁定等待信息

当事务更新表中的一行，或使用`select ... for update`锁定它时，InnoDB 会为对应的行建立一个列表或锁定队列。同样，InnoDB  会为每个表的表级锁建立一个锁列表。如果第二个事务想要更新行或锁定已经被先前事务以不兼容模式锁定的表，InnoDB 会将该行的锁定请求添加到响应的队列中。对于事务必须获取的锁，必须删除先前进入该行或表的锁队列的所有不兼容的锁请求（这发生在持有或请求这些锁的事务提交或回滚时）。

一个事务可能对不同的行或表有任意数量的锁定请求。在任何给定时间，一个事务可能请求被另一个事务持有的锁，在这种情况下，它会被另一个事务阻塞。请求事务必须等待持有阻塞锁提交或回滚。如果事务没有等待锁定（没有阻塞），它在 RUNNING 状态；如果事务正在等待锁定（阻塞），则它处于 LOCK WAIT 状态。（information_schema.innodb_trx 表展示这些状态值）

performance_schema.data_lockds 表为每个 LOCK WAIT 状态的事务保存一行或多行。指示阻止其进度的任何锁定请求；该表还包含一行描述给定行或表的待处理锁队列中的每个锁。

performance_shema.data_lock_waits 表 显示了事务以持有的哪些锁是其它事务请求的阻塞锁。
