# 聚集索引和二级索引

每个 InnoDB 表都有一个特殊索引，称之为聚集索引，用来存储行数据。通常，聚集索引和主键同义。为了在查询、插入和其他操作上获取最佳性能，去理解 InnoDB 如何使用聚集索引去优化常见查找和 DML 操作是非常重要的。

- 当你在一个表上定义主键时，InnoDB 将会把它当作聚集索引来使用。每个表都应该定义一个主键，如果没有唯一非空的列或者没有定义主键列，请添加自增列（auto_increment），自增列值唯一，并且在新行插入时自增
- 如果你没有定义主键，InnoDB 会使用第一个非空的唯一索引，用来当作聚集索引
- 如果一个表没有定义主键并且没有合适的唯一索引，InnoDB 将会生成一个隐藏的聚集索引，称之为 GEN_CLUST_INDEX，该索引构建在包含行 ID 值的合成列之上，按照 InnoDB 分配的行 ID 排序。行 ID 是一个 6 字节的字段，会随着插入新行而单调递增，因此，按行 ID 排序的行在物理存储上是按插入顺序排列的。

### 聚集索引如何加快查询速度

通过聚集索引访问一行很快，因为索引搜索直接指向包含数据的页面。如果表很大，与使用与索引记录不同的页面存储数据的存储结构相比，聚集索引科技节省磁盘 I/O 操作。

### 二级索引和聚集索引的关系

聚集索引以外的索引称为二级索引。在 InnoDB 中，二级索引中的每条记录都包含该行的主键列，以及为二级索引指定的列，InnoDB 使用该主键值在聚集索引中搜索该行数据。

如果主键索引很大，则二级索引会占用更多的空间，所以主键短诗更有利的。

有关利用`InnoDB` 聚集索引和二级索引的指南，请参阅 [第 8.3 节 “优化和索引”](https://dev.mysql.com/doc/refman/5.7/en/optimization-indexes.html)。
